Objet : Proposition de révision des dimensions des machines virtuelles

Bonjour,

Suite aux recommandations de Guillaume et Benoît concernant la révision des dimensions des machines virtuelles dans le but d’optimiser les performances et les coûts, je t’adresse ci-joint un fichier Excel comportant :

Une feuille "proposition" contenant des détails sur l’utilisation des ressources des VMs administrées par toi.

Une feuille "vm size" présentant les spécifications techniques des VMs existantes ainsi que celles des VMs proposées pour un redimensionnement.


Merci d’effectuer les analyses nécessaires et de fournir tes retours dans la colonne "remarques", en précisant la faisabilité du redimensionnement. Si ce dernier n’est pas envisageable, merci de proposer la réservation des machines virtuelles pour une durée d’un an ou de trois ans, en fonction des tarifs indiqués dans la feuille "vm size".

Cordialement,

# Variables
$ListeNomsPath = "C:\Chemin\Vers\Noms.xlsx"  # Remplacez par le chemin de votre fichier contenant les noms
$TemplatePath = "C:\Chemin\Vers\Template.xlsx"  # Remplacez par le chemin du template
$OutputFolder = "C:\Chemin\Vers\Sortie"  # Remplacez par le dossier de sortie

# Chargement du module Excel si nécessaire
if (-not (Get-Module -Name ImportExcel -ListAvailable)) {
    Install-Module -Name ImportExcel -Force -Scope CurrentUser
}

# Importation du module
Import-Module ImportExcel

# Chargement des noms
$Noms = Import-Excel -Path $ListeNomsPath | Select-Object -ExpandProperty Noms

# Vérifie si le dossier de sortie existe
if (-not (Test-Path -Path $OutputFolder)) {
    New-Item -ItemType Directory -Path $OutputFolder | Out-Null
}

# Boucle pour créer un fichier par nom
foreach ($Nom in $Noms) {
    $NewFilePath = Join-Path -Path $OutputFolder -ChildPath "$Nom.xlsx"
    Copy-Item -Path $TemplatePath -Destination $NewFilePath
    Write-Output "Fichier créé : $NewFilePath"
}


Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned

.\GénérationExcel.ps1



# Définir les chemins
$sourceFolder = "C:\chemin\vers\repertoire\source"
$destinationFolder = "C:\chemin\vers\repertoire\destination"
$fileListCsv = "C:\chemin\vers\fichiers_a_copier.csv"

# Charger la liste des noms de fichiers depuis le CSV
$fileNames = Import-Csv -Path $fileListCsv | Select-Object -ExpandProperty Nom  # Remplacez "Nom" par le nom de la colonne du CSV

# Vérifier et copier les fichiers
foreach ($fileName in $fileNames) {
    $sourceFile = Join-Path -Path $sourceFolder -ChildPath $fileName
    $destinationFile = Join-Path -Path $destinationFolder -ChildPath $fileName

    if (Test-Path $sourceFile) {
        Copy-Item -Path $sourceFile -Destination $destinationFile
        Write-Host "Copié : $fileName"
    } else {
        Write-Host "Fichier introuvable : $fileName"
    }
}
